<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">

  <meta charset="utf-8">

  
<title>Helped a Homie with BITSCTF Using Python Internals</title>



<meta property="og:image" content="/images/apple-touch-icon.png" />


<meta name="author" content="Hemish">
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="follow.it-verification-code" content="ZKMZC8n02Bv0Hs9t1m3m"/>

 


<meta name="description" content="How I helped my friend with one of the questions in BITSCTF&#x27;25 with Python&#x27;s metaprogramming function">


  <link rel="stylesheet" href="/style.css">
  <link rel="icon" type="image/png" href="/favicon.ico">
</head>

<body>
  <header class="header-bar">
    <div class="header-content">
      <div class="mobile-header">
        <div class="hamburger" onclick="document.querySelector('.nav-links').classList.toggle('active')">
          <span class="bar"></span>
          <span class="bar"></span>
          <span class="bar"></span>
        </div>
        <div class="logo-container">
          <a href="/"><h1>Hemish</h1></a>
        </div>
      </div>
      <nav class="nav-links">
        <a href="/">Home</a>
        <a href="/posts">Posts</a>
        <a href="/poems">Poems</a>
        <a href="#contact">Contact</a>
        <a href="/subscribe">Subscribe/Atom</a>
      </nav>
    </div>
  </header>
  
  <style>
    /* Header Styles */
    .header-bar {
      width: 100%;
      background-color: #3d255b;
      color: #eaeaea;
      padding: 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
    }
  
    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      min-height: 52px;
    }
  
    .mobile-header {
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      height: 52px;
    }
  
    .logo-container h1 {
      margin: 0;
      font-size: 1.5rem;
      color: #00b4d8;
      line-height: 1;
      font-weight: 600;
    }
  
    /* Navigation Links */
    .nav-links {
      display: flex;
      gap: 12px;
    }
  
    .nav-links a {
      text-decoration: none;
      color: #eaeaea;
      padding: 6px 12px;
      border-radius: 3px;
      transition: background-color 0.3s, color 0.3s;
      font-size: 1rem;
      font-weight: 500;
    }
  
    .nav-links a:hover {
      background-color: #00b4d8;
      text-decoration: none;
      color: #12182b;
    }
  
    /* Hamburger Icon */
    .hamburger {
      display: none;
      flex-direction: column;
      gap: 4px;
      cursor: pointer;
      height: 21px;
      justify-content: center;
    }
  
    .hamburger .bar {
      width: 24px;
      height: 3px;
      background-color: #eaeaea;
      border-radius: 2px;
    }
  
    /* Mobile Responsiveness */
    @media screen and (max-width: 670px) {
      .header-content {
        flex-direction: column;
        align-items: stretch;
      }
  
      .mobile-header {
        position: relative;
        justify-content: center;
      }
  
      .hamburger {
        display: flex;
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
      }
  
      .logo-container {
        display: flex;
        align-items: center;
        height: 100%;
      }
  
      .logo-container h1 {
        font-size: 1.4rem;
      }
  
      .nav-links {
        display: none;
        flex-direction: column;
        gap: 8px;
        padding: 10px 0;
      }
  
      .nav-links a {
        padding: 8px 14px;
        font-size: 1rem;
      }
  
      .nav-links a:hover {
        background-color: #00b4d8;
        color: #12182b;
      }
    }
  
    /* Show navigation links when menu is active */
    .nav-links.active {
      display: flex;
    }
  </style>

  <!-- Content Wrapper -->
  <main class="content-wrapper">
    
<article>
  <div>
    
    <h1 id="blog-title">Helped a Homie with BITSCTF Using Python Internals</h1>
    
    <div class="blog-details">
      <span>
        <time>
          
          <small class="blog-date">2025-03-20</small>
          
          <br>
          
        </time>
      </span>
      
      
      Tags:
      
      <a href="/tags/programming">#programming</a>
      
      <a href="/tags/python">#python</a>
      
      
      
    </div>
  </div>
  
    <div id="blog">

      
      <p>A random Sunday at home, I get a call from my friend <a rel="noopener" target="_blank" href="https://skyeliner.github.io">skye</a> (asli naam nhi likhne de rha (he is not letting me write his original name)). He was, as usual, fiddling with cybersec stuff, sparing time from his busy gaming schedule. Initially, I ignored the call, but then answered. He was participating in <a rel="noopener" target="_blank" href="https://ctftime.org/event/2607/">BITSCTF '25</a>. He quickly asks me to have a look at a python file he sent me.</p>
<p>I, excited, opened the file, and I see the following <a rel="noopener" target="_blank" href="https://wiki.python.org/moin/Powerful%20Python%20One-Liners">Python one-liner</a>:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Python obfuscation by freecodingtools.org
</span><span>                    
</span><span style="color:#bf616a;">_ </span><span>= </span><span style="color:#b48ead;">lambda </span><span style="color:#bf616a;">__ </span><span>: </span><span style="color:#96b5b4;">__import__</span><span>(&#39;</span><span style="color:#a3be8c;">zlib</span><span>&#39;).</span><span style="color:#bf616a;">decompress</span><span>(</span><span style="color:#96b5b4;">__import__</span><span>(&#39;</span><span style="color:#a3be8c;">base64</span><span>&#39;).</span><span style="color:#bf616a;">b64decode</span><span>(__[::-</span><span style="color:#d08770;">1</span><span>]));</span><span style="color:#96b5b4;">exec</span><span>((</span><span style="color:#bf616a;">_</span><span>)(</span><span style="color:#b48ead;">b</span><span>&#39;</span><span style="color:#a3be8c;">==QfWoizP8/vvPv/tu.........a lot of random stuff...........WiUxyW7lVwJe</span><span>&#39;))
</span></code></pre>
<p>aahhhhh... so much random characters</p>
<p>The goal was to find a <a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Capture_the_flag_(cybersecurity)">flag</a>.</p>
<p>Let's first understand what the code is doing:</p>
<ul>
<li>
<p>First, a <a rel="noopener" target="_blank" href="https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions">lambda function</a> is being used. A lambda function allows definition of a function in a single line. It takes an argument (here <code>__</code>). It is followed by <code>:</code> which defines what the function should return. The function is assigned into a variable <code>_</code>.</p>
</li>
<li>
<p><code>__import__('zlib').decompress(...)</code> is equivalent to the following, thanks to Python's <a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Metaprogramming">metaprogramming</a> functions:</p>
</li>
</ul>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>zlib
</span><span>zlib.</span><span style="color:#bf616a;">decompress</span><span>(</span><span style="color:#d08770;">...</span><span>)
</span></code></pre>
<ul>
<li>Similarly, <code>__import__('base64').b64decode(...)</code> is equivalent to the following:</li>
</ul>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>base64
</span><span>base64.</span><span style="color:#bf616a;">decode</span><span>(</span><span style="color:#d08770;">...</span><span>)
</span></code></pre>
<ul>
<li>
<p><code>__[::-1])</code>, as everyone knows, reverses the string <code>__</code> (which is the argument for the function).</p>
</li>
<li>
<p><code>;</code>: A lot of people don't know, but Python supports semicolons. It, like in any other languages, can be used to separate two statements. It's not necessary, and also not a standard, but is useful to make one-liners (as here two python statements are there in a single line)</p>
</li>
<li>
<p><code>exec(...)</code>: It treats strings as Python statements, for example <code>exec("print('Hello World')")</code> would treat the string as a Python statement and execute it, resulting in output <code>Hello World</code>.</p>
</li>
<li>
<p>The random string which is given is actually encoded string, given as a raw binary string (base64 takes binary strings by default). The <code>_</code> function is thus called on the random string, passing the random string as the argument <code>__</code>.</p>
</li>
</ul>
<p>In essence, the function first reverses the string passed to it, decodes it via <a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Base64">base64</a>, and then decompresses it via <a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Zlib">zlib</a>. This is called on the random string.</p>
<p>I was feeling sus(picious) about the code as it is random string, and upon decoding, it could be any malicious code, and it is being run by <code>exec</code>. But, I took the riks, and executed the code. What output do I get?</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Hello, World!
</span></code></pre>
<p>Looks like a normal "Hello World!", huh</p>
<p>I replaced the <code>exec</code> with a <code>print</code> to see what code is being executed, instead of seeing the "Hello World!" output of the code:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Python obfuscation by freecodingtools.org
</span><span>                    
</span><span style="color:#bf616a;">_ </span><span>= </span><span style="color:#b48ead;">lambda </span><span style="color:#bf616a;">__ </span><span>: </span><span style="color:#96b5b4;">__import__</span><span>(&#39;</span><span style="color:#a3be8c;">zlib</span><span>&#39;).</span><span style="color:#bf616a;">decompress</span><span>(</span><span style="color:#96b5b4;">__import__</span><span>(&#39;</span><span style="color:#a3be8c;">base64</span><span>&#39;).</span><span style="color:#bf616a;">b64decode</span><span>(__[::-</span><span style="color:#d08770;">1</span><span>]));</span><span style="color:#96b5b4;">print</span><span>((</span><span style="color:#bf616a;">_</span><span>)(</span><span style="color:#b48ead;">b</span><span>&#39;</span><span style="color:#a3be8c;">==QfWoizP8/vvPv/tu.......................a lot of random stuff............................WiUxyW7lVwJe</span><span>&#39;))
</span><span>
</span></code></pre>
<p>Running this, I get the output:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">b</span><span>&quot;</span><span style="color:#a3be8c;">exec((_)(b&#39;=cE3wh5B//7.....a lot of random stuff..............xyWzlNwJe&#39;))</span><span>&quot;
</span></code></pre>
<p>W-w-whaaaatttt? The output is also a new python code using that function. I can't just exec it again. I need to find the stuff encoded in it. So, I strip out the <code>b"exec(</code> at start and <code>)"</code> at the end, to retrieve the contained string, and not execute it. I add the <code>print</code> statement to display it. In essence, I executed this:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#bf616a;">_ </span><span>= </span><span style="color:#b48ead;">lambda </span><span style="color:#bf616a;">__ </span><span>: </span><span style="color:#96b5b4;">__import__</span><span>(&#39;</span><span style="color:#a3be8c;">zlib</span><span>&#39;).</span><span style="color:#bf616a;">decompress</span><span>(</span><span style="color:#96b5b4;">__import__</span><span>(&#39;</span><span style="color:#a3be8c;">base64</span><span>&#39;).</span><span style="color:#bf616a;">b64decode</span><span>(__[::-</span><span style="color:#d08770;">1</span><span>]));
</span><span style="color:#96b5b4;">print</span><span>((</span><span style="color:#bf616a;">_</span><span>)(</span><span style="color:#b48ead;">b</span><span>&#39;</span><span style="color:#a3be8c;">=cE3wh5B.........a lot of random stuff.....yWzlNwJe</span><span>&#39;))
</span></code></pre>
<p>The string passed in this is not the string given initially. This string is the one generated by the run of program.</p>
<p>Executing the above code, I get the output:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">b</span><span>&quot;</span><span style="color:#a3be8c;">exec((_)(b&#39;==AiELbHP4///....a lot of random stuff......Bt7jfZBVgcxyW0lVwJe&#39;))</span><span>&quot;
</span></code></pre>
<p>aaaahhhhh.... another one</p>
<p>How long should this go? I visited the website given in comment in the initial program: <a rel="noopener" target="_blank" href="https://freecodingtools.org">freecodingtools.org</a>. From the homepage, I found "Python Obfuscator", which says:</p>
<blockquote>
<p>Python code is ran through this algorithm 100s of times, each time making it more secure and unreadable.</p>
</blockquote>
<p>100s? aah. I wrote a for loop to automate this decoding the string.</p>
<p>But where to break the loop? The loop should break when the decoding is no longer possible, i.e. an exception is raised by any of the decoding functions base64decode or zlib.decompress</p>
<p>This is the loop I wrote:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span>decode_obfuscated = </span><span style="color:#b48ead;">lambda </span><span style="color:#bf616a;">__ </span><span>: </span><span style="color:#96b5b4;">__import__</span><span>(&#39;</span><span style="color:#a3be8c;">zlib</span><span>&#39;).</span><span style="color:#bf616a;">decompress</span><span>(</span><span style="color:#96b5b4;">__import__</span><span>(&#39;</span><span style="color:#a3be8c;">base64</span><span>&#39;).</span><span style="color:#bf616a;">b64decode</span><span>(__[::-</span><span style="color:#d08770;">1</span><span>]))
</span><span>string = &#39;</span><span style="color:#a3be8c;">==AiELbHP4///....a lot of random stuff......Bt7jfZBVgcxyW0lVwJe</span><span>&#39;
</span><span>
</span><span style="color:#b48ead;">for </span><span>i </span><span style="color:#b48ead;">in </span><span style="color:#96b5b4;">range</span><span>(</span><span style="color:#d08770;">100</span><span>):
</span><span>    </span><span style="color:#b48ead;">try</span><span>:
</span><span>        temp = </span><span style="color:#bf616a;">decode_obfuscated</span><span>(string)
</span><span>        string = temp[</span><span style="color:#d08770;">11</span><span>:-</span><span style="color:#d08770;">3</span><span>]
</span><span>        
</span><span>    </span><span style="color:#b48ead;">except</span><span>:
</span><span>        </span><span style="color:#96b5b4;">print</span><span>(temp)
</span><span>        </span><span style="color:#96b5b4;">print</span><span>(string)
</span><span>        </span><span style="color:#b48ead;">break
</span></code></pre>
<ul>
<li>The string slicing  [11:-3] strips out <code>b"exec((_)(b'</code> from start and <code>'))"</code> from end, to get the string of new iteration.</li>
<li>When the decompression or decoding is no longer possible, exception is raised and loop is terminated via 'break' statement.</li>
</ul>
<p>Running the program:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>b&#39;# Online Python Compiler\n\nprint(&quot;Hello, World!&quot;)\n# BITSCTF{obfuscation_and_then_some_more_obfuscation_4a4a4a4a}&#39;
</span><span>b&#39;thon Compiler\n\nprint(&quot;Hello, World!&quot;)\n# BITSCTF{obfuscation_and_then_some_more_obfuscation_4a4a4a&#39;
</span></code></pre>
<p>Flag found:</p>
<p><code>obfuscation_and_then_some_more_obfuscation_4a4a4a4a</code>, bye</p>

    </div>



    <!-- Subscribe popup -->
    <div id="popupOverlay">
      <div id="popup">
        <button id="close-btn" class="close-btn">&times;</button>
          <h2>Subscribe to my posts</h2>
          <p>Stay updated with my posts via Email or Atom</p>
          <button onclick="subscribe()">Subscribe</button>
      </div>
  </div>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const popupOverlay = document.getElementById('popupOverlay');
    let popupShown = false;

    // Check if URL starts with /posts
    if (window.location.pathname.startsWith('/posts')) {
        window.addEventListener('scroll', () => {
            const scrollTop = window.scrollY;
            const scrollHeight = document.documentElement.scrollHeight;
            const clientHeight = document.documentElement.clientHeight;

            // Show popup when near the bottom of the page
            if (!popupShown && scrollHeight - scrollTop - clientHeight < 100) {
                popupOverlay.style.display = 'flex';
                popupShown = true;
            }
        });
    }

    // Subscribe function
    window.subscribe = () => {
        window.location.pathname = "/subscribe"
        popupOverlay.style.display = 'none';
    };

    // Close popup when clicking outside
    popupOverlay.addEventListener('click', (e) => {
        if (e.target === popupOverlay) {
            popupOverlay.style.display = 'none';
        }
    });

    // Close popup with Esc key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && popupShown) {
            popupOverlay.style.display = 'none';
        }
    });

    const closeButton = document.getElementById('close-btn');

    closeButton.addEventListener('click', () => {
        popupOverlay.style.display = 'none';
    });
});
</script>
  <!-- Subscribe popup -->

</article>
<script>
document.querySelectorAll('pre').forEach((pre) => {
    // Create a copy button
    const button = document.createElement('button');
    button.innerText = 'Copy';
    button.className = 'copy-btn';
  
    // Add click event to copy the content
    button.addEventListener('click', () => {
      // Create a temporary container to hold the text
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = pre.innerHTML; // Get the HTML of the pre block
      tempDiv.querySelector('.copy-btn')?.remove(); // Remove the button from the content
  
      // Copy only the cleaned text content
      const code = tempDiv.innerText;
      navigator.clipboard.writeText(code).then(() => {
        button.innerText = 'Copied!';
        setTimeout(() => (button.innerText = 'Copy'), 2000);
      }).catch(() => {
        button.innerText = 'Failed!';
      });
    });
  
    // Append the button to the pre element
    pre.style.position = 'relative';
    pre.appendChild(button);
  });
</script>

    
  </main>

  

  <!-- Footer -->
  <footer>
    <div id="contact">
      Links: <br><br>
      <nav>
        
        <a target="_blank" rel="me" href="https:&#x2F;&#x2F;linkedin.com&#x2F;in&#x2F;imhemish"><button>LinkedIn</button></a>
        
        <a target="_blank" rel="me" href="https:&#x2F;&#x2F;github.com&#x2F;imhemish"><button>GitHub</button></a>
        
        <a target="_blank" rel="me" href="https:&#x2F;&#x2F;matrix.to&#x2F;#&#x2F;@hemish:matrix.org"><button>Matrix</button></a>
        
        <a target="_blank" rel="me" href="https:&#x2F;&#x2F;telegram.me&#x2F;imported_maal"><button>Telegram</button></a>
        
        <a target="_blank" rel="me" href="mailto:hemish04082005@gmail.com"><button>Email</button></a>
        
        <a target="_blank" rel="me" href="https:&#x2F;&#x2F;instagram.com&#x2F;imhemish"><button>Instagram</button></a>
        
      </nav>
    </div>
    <br>
    <hr><br>
    Special thanks to: <br><br>
    <nav>
      
      <button>
        <a target="_blank" href="https:&#x2F;&#x2F;bugswriter.com">
          <img src="https:&#x2F;&#x2F;bugswriter.com&#x2F;favicon.ico" height=30 width=30 alt="BugsWriter">
        </a>
      </button>
      
      <button>
        <a target="_blank" href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;India">
          <img src="https:&#x2F;&#x2F;upload.wikimedia.org&#x2F;wikipedia&#x2F;en&#x2F;4&#x2F;41&#x2F;Flag_of_India.svg" height=30 width=30 alt="India">
        </a>
      </button>
      
      <button>
        <a target="_blank" href="https:&#x2F;&#x2F;en.wikipedia.org&#x2F;">
          <img src="https:&#x2F;&#x2F;upload.wikimedia.org&#x2F;wikipedia&#x2F;en&#x2F;8&#x2F;80&#x2F;Wikipedia-logo-v2.svg" height=30 width=30 alt="Wikipedia">
        </a>
      </button>
      
      <button>
        <a target="_blank" href="https:&#x2F;&#x2F;gnome.org">
          <img src="https:&#x2F;&#x2F;upload.wikimedia.org&#x2F;wikipedia&#x2F;commons&#x2F;6&#x2F;68&#x2F;Gnomelogo.svg" height=30 width=30 alt="GNOME">
        </a>
      </button>
      
      <button>
        <a target="_blank" href="https:&#x2F;&#x2F;kernel.org">
          <img src="https:&#x2F;&#x2F;upload.wikimedia.org&#x2F;wikipedia&#x2F;commons&#x2F;a&#x2F;af&#x2F;Tux.png" height=30 width=30 alt="Linux">
        </a>
      </button>
      
    </nav>
    <br>(Not endorsed by any of these)
    <br><br>
    &copy Copyright 2025 <a href="/">Hemish</a>. Few rights reserved:
    The content on this site is available under <a href="https://creativecommons.org/licenses/by/4.0/legalcode"
      target="_blank"> CC-BY-4.0 license</a>, that is you can use the content as long as you credit me and list this
    site as a source.
  </footer>

  <script src="/elasticlunr.min.js"></script>
  <script src="/search_index.en.js"></script>
  <script src="/js/search.js"></script>
</body>

</html>
